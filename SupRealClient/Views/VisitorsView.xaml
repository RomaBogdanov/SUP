<mah:MetroWindow x:Class="SupRealClient.Views.VisitorsView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:converters="clr-namespace:SupRealClient.Behaviour"
        mc:Ignorable="d"
        Title="Посетители" Height="900" Width="900"
        ResizeMode="NoResize" WindowStartupLocation="CenterScreen"
        Closing="Window_Closing">

    <mah:MetroWindow.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
    </mah:MetroWindow.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="0.6*"/>
            <RowDefinition Height="0.7*"/>
            <RowDefinition Height="0.25*"/>
            <RowDefinition Height="1.8*"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        
        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition Width="0.3*"/>
        </Grid.ColumnDefinitions>
        
        <Grid
            Grid.Row="0"
            Grid.Column="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition Height="2*"/>
            </Grid.RowDefinitions>
            
            <TextBlock
                Grid.Row="0"
                Grid.Column="0"
                Text="Фамилия"
                Style="{StaticResource TextBLockStyle}"/>

            <TextBox
                TabIndex="0"
                Text="{Binding Path=CurrentItem.Family, Mode=TwoWay}"
                Grid.Row="1"
                Grid.Column="0"
                IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                Style="{StaticResource TextBoxStyle}"/>
            
            <TextBlock
                Grid.Row="0"
                Grid.Column="1"
                Text="Имя"
                Style="{StaticResource TextBLockStyle}"/>

            <TextBox
                TabIndex="1"
                Text="{Binding Path=CurrentItem.Name, Mode=TwoWay}"
                Grid.Row="1"
                Grid.Column="1"
                IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                Style="{StaticResource TextBoxStyle}"/>
            
            <TextBlock
                Grid.Row="0"
                Grid.Column="2"
                Text="Отчество"
                Style="{StaticResource TextBLockStyle}"/>

            <TextBox
                TabIndex="2"
                Text="{Binding Path=CurrentItem.Patronymic, Mode=TwoWay}"
                Grid.Row="1"
                Grid.Column="2"
                IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                Style="{StaticResource TextBoxStyle}"/>
        </Grid>

        <Button
            Grid.Row="0"
            Grid.RowSpan="2"
            Grid.Column="1"
            ToolTip="Добавить фото"
            Margin="0"
            Background="#00000000"
            IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
            Command="{Binding AddImageSourceCommand}">
            <Grid Height="240" Width="180">
                <Grid.RowDefinitions>
                    <RowDefinition Height="40"/>
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="40"/>
                </Grid.ColumnDefinitions>

                <Border
                    Grid.Row="0"
                    Grid.RowSpan="2"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    BorderThickness="2"
                    BorderBrush="#FFCCCCCC">
                    <Image 
                        Source="{Binding Path=PhotoSource, Mode=OneWay}" />
                </Border>
                <Button
                    Grid.Row="0"
                    Grid.Column="1"
                    Content="X"
                    ToolTip="Удалить фото"
                    Margin="0"
                    Background="#00000000"
                    BorderThickness="2"
                    BorderBrush="#FFCCCCCC"
                    Command="{Binding RemoveImageSourceCommand}"/>
            </Grid>
        </Button>

        <Grid
            Grid.Row="1"
            Grid.Column="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition/>
                <ColumnDefinition Width="50"/>
                <ColumnDefinition Width="50"/>
            </Grid.ColumnDefinitions>
            
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            
            <TextBlock
                Grid.Row="0"
                Grid.Column="0"
                Text="Организация"
                Style="{StaticResource TextBLockStyle}"/>

            <TextBox
                TabIndex="3"
                Text="{Binding Path=CurrentItem.Organization, Mode=TwoWay}"
                Grid.Row="0"
                Grid.Column="1"
                IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                Style="{StaticResource TextBoxStyle}"
                IsReadOnly="True"/>
            
            <Button
                TabIndex="4"
                Command="{Binding Path=OrganizationCommand}"
                Grid.Row="0"
                Grid.Column="2"
                Content="..."
                Height="25"
                Width="25"
                IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                Style="{StaticResource VisitorsSquareButtonStyle}"/>

            <Button
                Command="{Binding ClearCommand}"
                CommandParameter="Organization"
                TabIndex="5"
                Grid.Column="3"
                Height="25"
                Width="25"
                Margin="0"
                Content="X"
                IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                Style="{StaticResource VisitorsSquareButtonStyle}"/>

            <TextBlock
                Grid.Row="1"
                Grid.Column="0"
                Text="Примечания"
                Style="{StaticResource TextBLockStyle}"/>

            <TextBox
                TabIndex="6"
                Text="{Binding Path=CurrentItem.Comment, Mode=TwoWay}"
                Grid.Row="1"
                Grid.Column="1"
                IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                Style="{StaticResource TextBoxStyle}"/>

            <Button
                TabIndex="7"
                Grid.Row="1"
                Grid.Column="2"
                Content="..."
                Height="25"
                Width="25"
                IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                Style="{StaticResource VisitorsSquareButtonStyle}"/>

            <Button
                Command="{Binding ClearCommand}"
                CommandParameter="Comment"
                TabIndex="8"
                Grid.Row="1"
                Grid.Column="3"
                Height="25"
                Width="25"
                Margin="0"
                Content="X"
                IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                Style="{StaticResource VisitorsSquareButtonStyle}"/>
        </Grid>
        
        <Grid
            Grid.Row="2"
            Grid.Column="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            
            <Grid
                Grid.Column="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="30"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                
                <CheckBox
                    TabIndex="9"
                    IsChecked="{Binding Path=CurrentItem.IsAccessDenied, Mode=TwoWay}"
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"/>
                
                <TextBlock 
                    Grid.Column="1"
                    Text="Вход запрещён"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Left"/>
            </Grid>

            <Grid
                Grid.Column="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="30"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>

                <CheckBox
                    TabIndex="10"
                    IsChecked="{Binding Path=CurrentItem.IsCanHaveVisitors, Mode=TwoWay}"
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"/>
                
                <TextBlock 
                    Grid.Column="1"
                    Text="Принимающее лицо"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Left"/>
            </Grid>

            <Grid
                Grid.Column="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="30"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>

                <CheckBox
                    TabIndex="11"
                    IsChecked="{Binding Path=CurrentItem.IsNotFormular, Mode=TwoWay}"
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"/>
                
                <TextBlock 
                    Grid.Column="1"
                    Text="Нет формуляра"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Left"/>
            </Grid>
        </Grid>
        
        <Grid
            Grid.Row="3"
            Grid.Column="0"
            Grid.ColumnSpan="2">
            <mah:MetroAnimatedTabControl
                Margin="5">
                <mah:MetroTabItem Header="Основная">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="0.3*"/>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="80"/>
                        </Grid.ColumnDefinitions>
                        
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition Height="4*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Text="Контактные телефоны"
                            FontSize="15"
                            TextWrapping="Wrap"
                            HorizontalAlignment="Left"
                            Style="{StaticResource TextBLockStyle}"/>
                        
                        <TextBox
                            TabIndex="12"
                            Text="{Binding Path=CurrentItem.Telephone, Mode=TwoWay}"
                            Grid.Row="0"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            HorizontalAlignment="Stretch"
                            IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                            Style="{StaticResource TextBoxStyle}"/>

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Text="Гражданство"
                            FontSize="15"
                            TextWrapping="Wrap"
                            HorizontalAlignment="Left"
                            Style="{StaticResource TextBLockStyle}"/>

                        <TextBox
                            TabIndex="13"
                            Text="{Binding Path=CurrentItem.Nation, Mode=TwoWay}"
                            Grid.Row="1"
                            Grid.Column="1"
                            HorizontalAlignment="Stretch"
                            IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                            Style="{StaticResource TextBoxStyle}"
                            IsReadOnly="True"/>
                        
                        <Grid
                            Grid.Row="1"
                            Grid.Column="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                        
                            <Button
                                TabIndex="14"
                                Command="{Binding CountryCommand}"
                                Grid.Column="0"
                                Height="25"
                                Width="25"
                                Margin="0"
                                Content="..."
                                IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                Style="{StaticResource VisitorsSquareButtonStyle}"/>

                            <Button
                                Command="{Binding ClearCommand}"
                                CommandParameter="Nation"
                                TabIndex="15"
                                Grid.Column="1"
                                Height="25"
                                Width="25"
                                Margin="0"
                                Content="X"
                                IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                Style="{StaticResource VisitorsSquareButtonStyle}"/>
                        </Grid>
                       
                        <Grid
                            Grid.Row="2"
                            Column="0"
                            ColumnSpan="3">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="0.4*"/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition Height="0.5*"/>
                            </Grid.RowDefinitions>
                            
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="185"/>
                                <ColumnDefinition/>
                                <ColumnDefinition Width="70"/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock 
                                Grid.Row="0"
                                Grid.Column="0"
                                Text="Документы"
                                FontSize="15"
                                HorizontalAlignment="Left"
                                Style="{StaticResource TextBLockStyle}"/>

                            <ListBox
                                TabIndex="16"
                                Grid.Row="1"
                                Grid.Column="0"
                                Grid.RowSpan="2"
                                Grid.ColumnSpan="5"
                                BorderBrush="Black"
                                BorderThickness="1"
                                SelectedIndex="{Binding Path=SelectedMainDocument}"
                                ItemsSource="{Binding Path=CurrentItem.MainDocuments, Mode=OneWay}"/>

                            <Grid Grid.Row="3" Grid.ColumnSpan="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Button
                                    Command="{Binding OpenMainDocumentCommand}"
                                    TabIndex="40"
                                    Grid.Column="1"
                                    Margin="2"
                                    Height="25"
                                    Content="Просмотр"
                                    IsEnabled="{Binding Path=ButtonEnable, Converter={StaticResource InverseBooleanConverter}, Mode=TwoWay}"
                                    Style="{StaticResource VisitorsSquareButtonStyle}"/>

                                <Button
                                    Command="{Binding AddMainDocumentCommand}"
                                    TabIndex="17"
                                    Grid.Column="2"
                                    Margin="2"
                                    Height="25"
                                    Width="25"
                                    Content="+"
                                    IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                    Style="{StaticResource VisitorsSquareButtonStyle}"/>
                                <Button
                                    Command="{Binding EditMainDocumentCommand}"
                                    TabIndex="18"
                                    Grid.Column="3"
                                    Margin="2"
                                    Height="25"
                                    Width="25"
                                    Content="..."
                                    IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                    Style="{StaticResource VisitorsSquareButtonStyle}"/>
                                <Button
                                    Command="{Binding RemoveMainDocumentCommand}"
                                    TabIndex="19"
                                    Grid.Column="4"
                                    Margin="2"
                                    Height="25"
                                    Width="25"
                                    Content="X"
                                    IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                    Style="{StaticResource VisitorsSquareButtonStyle}"/>
                            </Grid>


                            <Grid
                                Grid.Row="4"
                                Grid.Column="0"
                                Grid.ColumnSpan="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="60"/>
                                    <ColumnDefinition Width="150"/>
                                </Grid.ColumnDefinitions>

                                <CheckBox 
                                    TabIndex="24"
                                    IsChecked="{Binding Path=CurrentItem.IsAgree, Mode=TwoWay}"
                                    Grid.Column="0"
                                    HorizontalAlignment="Center"
                                    IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                                    VerticalAlignment="Center"/>

                                <TextBlock
                                    Grid.Column="1"
                                    Text="Согласие на обработку персональных данных"
                                    HorizontalAlignment="Left"
                                    Style="{StaticResource TextBLockStyle}"/>

                                <TextBlock
                                    Grid.Column="2"
                                    Text="Дата"
                                    Style="{StaticResource TextBLockStyle}"/>
                                
                                <DatePicker
                                    TabIndex="25"
                                    Grid.Column="3"
                                    SelectedDate="{Binding Path=CurrentItem.AgreeToDate, Mode=TwoWay}"
                                    IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                                    Text="Дата">
                                    <DatePicker.Resources>
                                        <Style TargetType="{x:Type DatePickerTextBox}">
                                            <Setter Property="Control.Template">
                                                <Setter.Value>
                                                    <ControlTemplate>
                                                        <TextBox 
                                                            x:Name="PART_TextBox"
                                                            ToolTip="Выберите дату"
                                                            Text="{Binding Path=SelectedDate, StringFormat='dd.MM.yyyy', 
                                                            RelativeSource={RelativeSource AncestorType={x:Type DatePicker}}}" />
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </DatePicker.Resources>
                                </DatePicker>
                            </Grid>
                        </Grid>
                    </Grid>
                </mah:MetroTabItem>
                <mah:MetroTabItem 
                    Header="Пропуска"
                    Visibility="{Binding AccessVisibility,
                    Converter={StaticResource BooleanToVisibilityConverter}}">
                    <DataGrid 
                        ItemsSource="{Binding Path=CurrentItem.Cards}"
                        CanUserAddRows="False"
                        Style="{StaticResource AzureDataGrid1}">
                        <DataGrid.Columns>
                            <DataGridTextColumn 
                                Header="Пропуск" Binding="{Binding Path=Card}"/>
                            <DataGridTextColumn 
                                Header="Когда выдан" Binding="{Binding Path=From}"/>
                            <DataGridTextColumn 
                                Header="Срок по" Binding="{Binding Path=To}"/>
                            <DataGridTextColumn 
                                Header="Изменён" Binding="{Binding Path=Change}"/>
                            <DataGridTextColumn 
                                Header="Оператор" 
                                Width="*" 
                                Binding="{Binding Path=Operator}"/>
                            <DataGridTextColumn 
                                Header="№ заявки" Binding="{Binding Path=OrderNum}"/>
                            <DataGridTextColumn 
                                Header="Дополнительно" Binding="{Binding Path=Comment}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </mah:MetroTabItem>
                <mah:MetroTabItem 
                    Header="Заявки" 
                    Visibility="{Binding AccessVisibility, 
                    Converter={StaticResource BooleanToVisibilityConverter}}">
                    <DataGrid Style="{StaticResource AzureDataGrid1}" 
                              ItemsSource="{Binding Path=CurrentItem.Orders}"
                              CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="№ заявки" Binding="{Binding Path=RegNumber}"/>
                            <DataGridTextColumn Header="Дата/время от" Binding="{Binding Path=From}"/>
                            <DataGridTextColumn Header="Дата/время до" Binding="{Binding Path=To}"/>
                            <DataGridTextColumn Header="Принимающее лицо" Binding="{Binding Path=Catcher}"/>
                            <DataGridTextColumn Header="Тип заявки" Binding="{Binding Path=OrderType}"/>
                            <DataGridTextColumn Header="Проходы" Binding="{Binding Path=Passes}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </mah:MetroTabItem>
                <mah:MetroTabItem Header="Сотрудник">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition Height="1.5*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock
                            Grid.Row="0" 
                            Grid.Column="0"
                            Text="Поздразделение:"
                            Style="{StaticResource TextBLockStyle}"/>
                        
                        <TextBox
                            TabIndex="26"
                            Text="{Binding Path=CurrentItem.Department, Mode=TwoWay}"
                            Grid.Row="1"
                            Grid.RowSpan="3"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Margin="2"
                            IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                            Style="{StaticResource TextBoxStyle}"
                            TextWrapping="Wrap"
                            AcceptsReturn="True"
                            VerticalScrollBarVisibility="Visible"
                            VerticalAlignment="Stretch"
                            IsReadOnly="True"/>

                        <Grid
                            Grid.Row="1"
                            Grid.Column="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            
                            <Button
                                Command="{Binding DepartmentsCommand}"
                                TabIndex="27"
                                Grid.Column="0"
                                Content="..."
                                Margin="2"
                                Height="25"
                                Width="25"
                                IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                Style="{StaticResource VisitorsSquareButtonStyle}" />

                            <Button 
                                Command="{Binding ClearCommand}"
                                CommandParameter="Department"
                                TabIndex="28"
                                Grid.Column="1"
                                Content="X"
                                Margin="2"
                                Height="25"
                                Width="25"
                                IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                Style="{StaticResource VisitorsSquareButtonStyle}"/>
                        </Grid>
                        
                        <TextBlock
                            Grid.Row="4" 
                            Grid.Column="0"
                            Text="Должность:"
                            Style="{StaticResource TextBLockStyle}"/>

                        <ComboBox
                            Grid.Row="5"
                            Grid.Column="0"
                            Grid.ColumnSpan="4"
                            Margin="2"
                            TabIndex="29"
                            FontSize="{Binding FontSize}"
                            IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                            SelectedValue="{Binding Path=CurrentItem.Position, Mode=OneWay}"
                            Text="{Binding Path=CurrentItem.Position, Mode=TwoWay}"
                            IsEditable="True"
                            ItemsSource="{Binding Path=PositionList}" />

                        <Grid
                            Grid.Row="6"
                                Grid.Column="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="30"/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>

                            <CheckBox
                                TabIndex="32"
                                IsChecked="{Binding Path=CurrentItem.IsRightSign, Mode=TwoWay}"
                                Grid.Column="0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"/>
                            
                            <TextBlock 
                                Grid.Column="1"
                                Text="Право подписи заявок"
                                FontSize="15"
                                HorizontalAlignment="Left"
                                Style="{StaticResource TextBLockStyle}"/>
                        </Grid>

                        <Grid
                            Grid.Row="6"
                            Grid.Column="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="30"/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>

                            <CheckBox
                                TabIndex="33"
                                IsChecked="{Binding Path=CurrentItem.IsAgreement, Mode=TwoWay}"
                                Grid.Column="0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"/>

                            <TextBlock 
                                Grid.Column="1"
                                Text="Право согласования заявок"
                                FontSize="15"
                                HorizontalAlignment="Left"
                                Style="{StaticResource TextBLockStyle}"/>
                        </Grid>
                        
                        <TextBlock
                            Grid.Row="7"
                            Grid.Column="0"
                            Text="Кабинет"
                            Style="{StaticResource TextBLockStyle}"/>
                        
                        <Grid
                            Grid.Row="8"
                            Grid.Column="0"
                            Grid.ColumnSpan="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition Width="70"/>
                                <ColumnDefinition Width="0.5*"/>
                                <ColumnDefinition Width="0.5*"/>
                            </Grid.ColumnDefinitions>
                            <TextBox
                                TabIndex="34"
                                Text="{Binding Path=CurrentItem.Cabinet, Mode=TwoWay}"
                                Margin="2"
                                Style="{StaticResource TextBoxStyle}"
                                IsEnabled="{Binding Path=TextEnable, Mode=TwoWay}"
                                IsReadOnly="True"/>

                            <Grid
                                Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>

                            <Button 
                                TabIndex="35"
                                Command="{Binding CabinetsCommand}"
                                Grid.Column="0"
                                Content="..."
                                Margin="2"
                                Height="25"
                                Width="25"
                                IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                Style="{StaticResource VisitorsSquareButtonStyle}"/>

                                <Button 
                                    Command="{Binding ClearCommand}"
                                    CommandParameter="Cabinet"
                                    TabIndex="36"
                                    Grid.Column="1"
                                    Content="X"
                                    Margin="2"
                                    Height="25"
                                    Width="25"
                                    IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                    Style="{StaticResource VisitorsSquareButtonStyle}"/>
                            </Grid>

                            <TextBlock
                                Grid.Column="2"
                                Text="Подпись"
                                FontSize="15"
                                HorizontalAlignment="Right"
                                Style="{StaticResource TextBLockStyle}"/>
                            
                            <Button
                                TabIndex="37"
                                Grid.Column="3"
                                ToolTip="Добавить подпись"
                                Margin="0"
                                Background="#00000000"
                                HorizontalAlignment="Right"
                                IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                Command="{Binding AddSignatureCommand}">
                                <Grid Height="40" Width="180">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="40"/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>

                                    <Border
                                        Grid.Row="0"
                                        Grid.RowSpan="2"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        BorderThickness="2"
                                        BorderBrush="#FFCCCCCC">
                                        <Image Source="{Binding Signature}"/>
                                    </Border>
                                    <Button
                                        TabIndex="38"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Content="X"
                                        ToolTip="Удалить подпись"
                                        Margin="0"
                                        Background="#00000000"
                                        BorderThickness="2"
                                        BorderBrush="#FFCCCCCC"
                                        Command="{Binding RemoveSignatureCommand}"/>
                                </Grid>
                            </Button>
                        </Grid>
                    </Grid>
                </mah:MetroTabItem>
                <mah:MetroTabItem Header="Документы">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="40"/>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <!--<Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>-->

                        <TextBlock
                            Grid.Row="0"
                            Text="Удостоверения личности"
                            FontSize="15"
                            Style="{StaticResource TextBLockStyle}"/>
                        
                        <ListBox
                            TabIndex="39"
                            Grid.Row="1"
                            BorderBrush="Black"
                            BorderThickness="1"
                            SelectedIndex="{Binding Path=SelectedDocument}"
                            ItemsSource="{Binding Path=CurrentItem.Documents, Mode=OneWay}"/>

                        <Grid Grid.Row="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Button
                                    Command="{Binding OpenDocumentCommand}"
                                    TabIndex="40"
                                    Grid.Column="1"
                                    Margin="2"
                                    Height="25"
                                    Content="Просмотр"
                                    IsEnabled="{Binding Path=ButtonEnable, Converter={StaticResource InverseBooleanConverter}, Mode=TwoWay}"
                                    Style="{StaticResource VisitorsSquareButtonStyle}"/>
                            <Button
                                    Command="{Binding AddDocumentCommand}"
                                    TabIndex="41"
                                    Grid.Column="2"
                                    Margin="2"
                                    Height="25"
                                    Width="25"
                                    Content="+"
                                    IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                    Style="{StaticResource VisitorsSquareButtonStyle}"/>
                            <Button
                                    Command="{Binding EditDocumentCommand}"
                                    TabIndex="42"
                                    Grid.Column="3"
                                    Margin="2"
                                    Height="25"
                                    Width="25"
                                    Content="..."
                                    IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                    Style="{StaticResource VisitorsSquareButtonStyle}"/>
                            <Button
                                    Command="{Binding RemoveDocumentCommand}"
                                    TabIndex="43"
                                    Grid.Column="4"
                                    Margin="2"
                                    Height="25"
                                    Width="25"
                                    Content="X"
                                    IsEnabled="{Binding Path=ButtonEnable, Mode=TwoWay}"
                                    Style="{StaticResource VisitorsSquareButtonStyle}"/>
                        </Grid>
                    </Grid>
                </mah:MetroTabItem>
            </mah:MetroAnimatedTabControl>
        </Grid>
        
        <Grid
            Grid.Row="4"
            Grid.Column="0"
            Grid.ColumnSpan="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="0.2*"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            
            <TextBlock
                Grid.Row="0"
                Grid.Column="0"
                Text="{Binding Path=CurrentItem.Operator, Mode=TwoWay}"
                FontSize="15"
                Margin="5"
                HorizontalAlignment="Left"
                Style="{StaticResource TextBLockStyle}"/>

            <TextBlock
                Grid.Row="0"
                Grid.Column="1"
                Text="Изменён ..."
                FontSize="15"
                Margin="5"
                HorizontalAlignment="Right"
                Style="{StaticResource TextBLockStyle}"/>
            
            <Grid
                Grid.Column="0"
                Grid.ColumnSpan="2"
                Grid.Row="1">
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>
                
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                
                <Button
                    Command="{Binding Path=BeginCommand}"
                    Grid.Row="0"
                    Grid.Column="0"
                    Margin="2"
                    ToolTip="Home"
                    IsEnabled="{Binding Path=VisitorsEnable.StartButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.StartButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Начало (2).ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="Начало"
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>

                <Button
                    Command="{Binding Path=PrevCommand}"
                    Grid.Row="0"
                    Grid.Column="1"
                    Margin="2"
                    ToolTip="↑"
                    IsEnabled="{Binding Path=VisitorsEnable.PreviousButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.PreviousButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Предыдущий (2).ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="Пред."
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>

                <Button
                    Command="{Binding Path=NextCommand}"
                    Grid.Row="0"
                    Grid.Column="2"
                    Margin="2"
                    ToolTip="↓"
                    IsEnabled="{Binding Path=VisitorsEnable.NextButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.NextButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Следующий (2).ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="След."
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>

                <Button
                    Command="{Binding Path=EndCommand}"
                    Grid.Row="0"
                    Grid.Column="3"
                    Margin="2"
                    ToolTip="End"
                    IsEnabled="{Binding Path=VisitorsEnable.EndButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.EndButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Конец (2).ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="Конец"
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>

                <Button
                    Grid.Row="0"
                    Grid.Column="4"
                    Margin="2"
                    IsEnabled="{Binding Path=VisitorsEnable.ExtraditeButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.ExtraditeButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}"
                    Command="{Binding ExtraditeCommand}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Выдать (2).ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="Выдать"
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>

                <Button
                    Grid.Row="0"
                    Grid.Column="5"
                    Margin="2"
                    IsEnabled="{Binding Path=VisitorsEnable.ReturnButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.ReturnButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}"
                    Command="{Binding ReturnCommand}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Возврат.ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="Возврат"
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>

                <Button
                    Command="{Binding NewCommand}"
                    Grid.Row="1"
                    Grid.Column="0"
                    Margin="2"
                    IsEnabled="{Binding Path=VisitorsEnable.NewButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.NewButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Добавить1 (2).ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="Новый"
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>

                <Button
                    Command="{Binding EditCommand}"
                    Grid.Row="1"
                    Grid.Column="1"
                    Margin="2"
                    ToolTip="Insert"
                    IsEnabled="{Binding Path=VisitorsEnable.EditButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.EditButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Редактировать (2).ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="Правка"
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>

                <Button
                    Command="{Binding OkCommand}"
                    Grid.Row="1"
                    Grid.Column="2"
                    Margin="2"
                    IsEnabled="{Binding Path=VisitorsEnable.AcceptButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.AcceptButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Принять (2).ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="Принять"
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>

                <Button
                    Command="{Binding CancelCommand}"
                    Grid.Row="1"
                    Grid.Column="3"
                    Margin="2"
                    ToolTip="Esc"
                    IsEnabled="{Binding Path=VisitorsEnable.CancelButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.CancelButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Отмена (2).ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="Отмена"
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>

                <Button
                    Command="{Binding FindCommand}"
                    Grid.Row="1"
                    Grid.Column="4"
                    Margin="2"
                    ToolTip="Ctrl+F"
                    IsEnabled="{Binding Path=VisitorsEnable.SearchButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.SearchButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Найти (2).ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="Найти"
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>

                <Button
                    Grid.Row="1"
                    Grid.Column="5"
                    Margin="2"
                    ToolTip="F5"
                    IsEnabled="{Binding Path=VisitorsEnable.RefreshButtonEnable, Mode=TwoWay}"
                    Visibility="{Binding Path=VisitorsVisible.RefreshButtonEnable, 
                    Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource VisitorsSquareButtonStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="0.3*"/>
                        </Grid.RowDefinitions>

                        <Image
                            Grid.Row="0"
                            Source="../Resources/Обновить (2).ico"/>

                        <TextBlock
                            Grid.Row="1"
                            Text="Обновить"
                            FontSize="12"
                            Style="{StaticResource TextBLockStyle}"/>
                    </Grid>
                </Button>
            </Grid>
        </Grid>
    </Grid>
</mah:MetroWindow>
